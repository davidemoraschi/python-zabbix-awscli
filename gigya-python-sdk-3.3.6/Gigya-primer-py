import json
import pandas as pd
from GSSDK import *

credentialFileCDC = "./gigya-python-sdk-3.3.6/credentialCDC.json"

with open(credentialFileCDC) as f:
    cre = pd.json_normalize(json.load(f))


# Define the API and Secret key (the keys can be obtained from your site setup page in the Gigya console).
apiKey = cre.iloc[0]["apiKey"]
secretKey = cre.iloc[0]["secret"]
userKey = cre.iloc[0]["userKey"]

# Step 1 - Defining the request and adding parameters
method = "audit.search"
params = {
    "query":"SELECT * FROM auditLog WHERE callID='f449cxxxxxxxxxxxxxxxxxxxx3abc026'"
}

request = GSRequest(apiKey,secretKey,method,params,False,userKey)

# Step 2 - Sending the request
response = request.send()

# Step 3 - handling the request's response.
if (response.getErrorCode()==0):
    # SUCCESS! response status = OK
    print("Success in audit.search operation.")
else:
    # Error
    print(f"Got error on audit.search:{response.getErrorCode()} {response.getErrorMessage()}")
    # You may also log the response: response.getLog()